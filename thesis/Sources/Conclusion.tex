% !TeX spellcheck = en_GB

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Conclusion}
\label{chap:conclusion}

This chapter finishes the thesis by summarizing its main points. It also includes suggestions how the plug-in could be further improved in the future.

\section{Summary}
\label{sec:summary}

This section gives an high level overview over the main points of this thesis. \\
The main points were:

\begin{enumerate}
\item How the goals described in Section \ref{sec:goals} were met
\item What the main problems were
\item How they were solved
\end{enumerate}

\subsubsection{Goals}

\begin{enumerate}[label=(\labelenum{G}{{\arabic*}}), wide, labelwidth=!, labelindent=0pt]
\setlength{\parskip}{0pt}
    \item \textbf{Easy-to-understand visualization of the encryption process}\\
    The first goal was met by creating a simple but thought-through user interface for the plug-in visualization.
    
     The visualization is split into five pages in the following order:\\
      A landing page, an overview page, a page to adjust diffusion settings, a page which visualizes the state setup and a page which visualizes the ChaCha hash function.\\
     Splitting the visualization up into five different pieces made it easier to let the user focus on a single step of the encryption process. This also made it possible to have a new page layout for each step without confusing the user because each page is presented as an individual piece. A new page layout for each step was useful because we then were not restricted to a single layout for the whole visualization. Presenting the pages as individual pieces starts with the clear cut from the landing page to the overview page using the page navigation bar in the top-left of each page. Since at the landing page, only the page navigation bar at the top-left is shown, the user knows that he must use it to advance. After using it, it is clear to the user that this is the place where he can navigate between pages.
     
     Each page tells the user with descriptions what it is about. If a page has what we called actions, the user has access to a slider with buttons in the bottom with which he can navigate within a page. At the bottom-right, the total actions a page has (which corresponds to in how many different states a page can be) is shown together with a text input which shows the current action index.
     
     Using that text input makes it possible to skip to a certain action. Since the user will not know which action corresponds to which page state when using the plug-in for the first time, additional buttons are shown above the slider which bring the user immediately to important intermediate steps. Looking at the current action index, the user now knows what he has to type in there to immediately jump to that action again. This indirectly helps to better understand the cipher because it enables student and lecturers to talk about a specific step using the action index number.
     
     The state setup and the hash function were visualized with attention to detail. \\
     During the state setup, each parameter is encoded separately and each encoding step is described. During the hash function, the quarter-round circuit diagram makes it possible to show the intermediate results in an intuitive way by placing them above the circuit lines. Intermediate results were important to let the user comprehend every single step of the keystream block generation. Further, background coloring helps to show which elements are used to calculate the next value or which state entries are currently in use by the quarter-round function.
     
     \item \textbf{Visualization of the diffusion property}\\
     The diffusion property is visualized by letting the user enter alternative values on the Diffusion page. Since the ChaCha keystream is independent of the plaintext, the user can only use alternative values for the key, counter and IV.
     
     It was important to easily be able to flip bits. Thus, the user can not only enter the explicit alternative value but also the XOR.
     
     An example on the same page informs the user what he can expect for the next pages if he activates diffusion by flipping at least one bit. It shows that he can chose between two views: \\
     A view where he can see both values and a view which can be activated with the button in the top-right corner to only show the XOR between both values.\\
     The values are always shown in hexadecimal and a character which has changed is marked red for easier visual recognition. These two different views were important because when studying the diffusion property of a cipher, one is more interested in the difference between two keystreams instead of their actual values. On the other hand, having access to the concrete values could also be useful thus both views were implemented instead of just one.
     
     Additionally, the percentage of flipped bits is shown below the state at the end of each quarter-round in the ChaCha hash function page.
     
     \item \textbf{Support for all variants of the cipher family}\\
     The support to choose the amount of rounds and the version (original version by Bernstein or IETF version) was implemented by adding appropriate settings to the plug-in. The inputs are then validated accordingly. This means that if the user has chosen the original version by Bernstein, he must enter a 64-bit counter and a 64-bit IV. If he has chosen the IETF version, he must enter a 32-bit counter and a 96-bit IV. The plug-in will not start with wrong inputs. Instead, it will show an error message with the expected size for the input and its actual size.
     
     The visualization works not much different with a 128-bit or 256-bit key. It is mentioned that if using a 128-bit key is used, it will be concatenated with itself. This is done in the step where the encoded key is put into the state.\\
     To reflect the chosen version, only the state setup is slightly different. The last row of the state is partitioned differently.
  \end{enumerate}

\section{Future Work}
\label{sec:futureWork}

This section lists suggestions how the plug-in could be further improved to make it more useful for the audience of CrypTool 2.

\begin{enumerate}[wide, labelwidth=!, labelindent=0pt]
\setlength{\parskip}{0pt}

\item \textbf{Better overview over flipped bits at the end of each round}\\
At the end of the Avalanche visualization, the author provided an overview over the percentage of flipped bits at the end of each round. This overview is very useful because it shows how the amount of flipped bits goes up very fast to around 50\% and then stays near it which is exactly what one would expect from a good cipher.

Using a plot instead of the simple text which is updated at the end of each round was considered but due to canvas and time constraints, this idea was not further pursued. 

Nonetheless, integrating such an overview into the Diffusion page should be possible. This would need cipher execution while still on the page instead on page exit but this would not be a big problem since a button to start cipher execution would suffice. Therefore, this plot could be an addition instead of replacing the text below the state in the ChaCha hash function visualization.

\item \textbf{Improve performance during diffusion}\\
All measurements in Section \ref{sec:Architecture} were done with inactive diffusion since the performance during active diffusion improved in a similar manner. This means that thanks to the centralized navigation system architecture, moving to any action is still done in constant time even if diffusion is active.

The problem is that it takes around one or two seconds for each move (instead of around 5 ms if diffusion was inactive) which is quite annoying. We suspect that this is the case because the red color is implemented by creating an inline element for every character and marking it red if it is different.

An idea is to create a single element for every possible combination of color (black and red) and hexadecimal character ([0-9A-F]). Therefore, we would not need to create a new inline element for each character but could reuse the same in multiple places. If the performance issue results from the memory allocation, this approach should solve it. 

However, first attempts resulted in weird bugs. So fixing this will probably be the most difficult point in this list and could result in once again having to rethink some major design decisions.

\item \textbf{Automatic navigation}\\
The AES visualization includes a button labeled with ``Auto''. It lets the visualization run without further user interaction needed. A slider was provided to adjust the speed (see Figure \ref{fig:aes}). 

Such a button could be useful for the ChaCha visualization, too, especially for the page about the ChaCha hash function with its many actions.\\
Since asynchronous navigation is already in use for the action slider, implementing this feature could easily be integrated within the existing navigation system. Only page switches could maybe need some clever solutions since the action navigation is handled within each page thus navigating out of a page may not be straight-forward. 

In the AES visualization though, the automatic navigation does stop between each step (which roughly corresponds to a page in our visualization) so switching the page automatically may even not be desired.

\item \textbf{Salsa20 visualization}\\
As mentioned in Section \ref{sec:salsaCT2Plugin}, using the now existing codebase for ChaCha visualization to create a Salsa20 visualization would definitely increase the value gained from this thesis.

This would at least need adaption of the XAML code for the state matrix initialization and the quarter-round since ChaCha and Salsa20 differ in these aspects from each other. It would most likely even increase the value of the ChaCha visualization since both ciphers could then be compared side-by-side. Comparing them and their diffusion property should be very easy due to the very similar visualization.

\item \textbf{Localization and online help}\\
Currently, most texts are only localized in English. Only the memo fields, component labels and plaintext value are also available in German.\\
This will be changed in the near future. Then also an online help entry for the ChaCha plug-in will be available. The online help appears when pressing F1.

\end{enumerate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%